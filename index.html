
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>A Computer Science blog  | Zeus@HackOlympus:~$</title>

	<meta name="author" content="Zeus"> 
	
	<meta name="description" content="So recently I played Bo1ler CTF. Normally I don&rsquo;t write writeups for a CTF (due to time constraints) but this time I decided to write one as I &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Zeus@HackOlympus:~$" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">


</head>



<body>
	<header id="header" class="inner"><h1><a href="/">Zeus@HackOlympus:~$</a></h1>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archive</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MFNXHS9HDQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MFNXHS9HDQ');
</script>



</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2021/04/06/Bo1ler-CTF-2021-writeup/">
		
			Bo1ler CTF -2021 Writeup</a>
	</h2>
	<div class="entry-content">
		<p>So recently I played Bo1ler CTF. Normally I don&rsquo;t write writeups for a CTF (due to time constraints) but this time I decided to write one as I found the challenges quite good and informative for beginners like me. Well hats off to Bo1ler CTF team.</p>

<p>I am writing this writeup mainly for <strong>pyjail</strong> challenges so my main focus will be on them only but I&rsquo;ll be providing the writeups for other challenges also.</p>

<h4><strong>Jails</strong></h4>

<h4>Pyjailgolf1</h4>

<p>So in this challenge we were given the following code which was running on the shell server <code>nc chal.b01lers.com 1334</code> :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">line</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;&gt;&gt;&gt; &#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">flag</span><span class="o">=</span><span class="s">&quot;\[REDACTED\]&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span class='line'>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">try</span><span class="p">:</span>
</span><span class='line'>    <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span class='line'><span class="k">except</span><span class="p">:</span>
</span><span class='line'>    <span class="k">pass</span>
</span></code></pre></td></tr></table></div></figure>


<p>Basically there is an <strong><code>eval</code></strong> function which is vulnerable. You will input any python command and it will be executed. But this was not the problem, problem was that we have to print the value of variable flag by running a command whose length is less than 10 chars. Now if you simply do <code>print(flag)</code> it will not work and will raise an Exception. All other commands like hex(), id(), exec() etc will not work because they are functions and they return the value rather than printing it. So calling them is no good for us.</p>

<p>Now you see why I am writing a writeup for this challenge. Because its so small, simple and cute yet challenging. Its a pure &ldquo;out of the box&rdquo; thinking challenge. Every beginner can approach this because it doesn&rsquo;t require a specific skillset like pwn (binary exploitation) challenges (except python but lets be honest, who doesn&rsquo;t know it üò¨) .</p>

<p>Well after going through my python notes and doing some research work on google I found a command <code>help()</code>. Yup! the answer was help command !!</p>

<p><img src="/images/boiler/image-1.png" class="center" style="width: 60%"></p>

<p><strong>Flag:</strong> <code>pctf{JusT_a5k_4_h3lP!}</code></p>

<p>See the most basic commands which we neglect during our learning period helped us in this challenge. After this I researched more on <code>help()</code> command and by luck next jail challenge could be done using <code>help()</code> command itself.</p>

<h3>Pyjailgolf2</h3>

<p>This challenge is almost same as the last one the only difference is the char limit. This time we have to do all our work in just 9 chars. Lets take a look at the script :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">line</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;&gt;&gt;&gt; &#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">flag</span><span class="o">=</span><span class="s">&quot;\[REDACTED\]&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
</span><span class='line'>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">try</span><span class="p">:</span>
</span><span class='line'>    <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span class='line'><span class="k">except</span><span class="p">:</span>
</span><span class='line'>    <span class="k">pass</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>nc chal.b01lers.com 1335</code></p>

<p>So as I said before this time we will use <code>help()</code> command like before but there is a little change of plans. Rather than using <code>help(flag)</code> to read the value of variable flag we will use <code>help()</code> interactive version.</p>

<p><img src="/images/boiler/image-2.png" class="center" style="width: 60%"></p>

<p>So the,</p>

<p><strong>Flag</strong> <code>pctf{Un1c0d3_i5_sw34t}</code></p>

<p>I don&rsquo;t know if this is the intended method to solve because by looking at the flag it doesn&rsquo;t look like it but whatever, we got the flag ¬Ø\_(„ÉÑ)_/¬Ø .</p>

<p>Well this is it I was only able to do the first 2 pyjails. So lets move to other challenge categories .</p>

<h2><strong>Reverse Engineering</strong></h2>

<h3>weenie_hut_general</h3>

<p>This challenge was an easy reverse engineering challenge. I am not a reverse engineering player myself but I was able to do it easily.</p>

<p>The given files can be found from this <a href="https://ctf.b01lers.com/download?file_key=ad1a1baf12da64c84dc72ecc9befccddec544cd0310acefb87275692d212f7a3&amp;team_key=c2e8f607c31b1896dfe445997fb87e1315424096425ea90c9b38ee0cd0b39032">link</a></p>

<p>So running the file is no good as it does not contain main function and will return a Segmentation fault. Lets open it in ghidra and see the decompiled source code.</p>

<p>Upon opening in ghidra I found a function <code>trytorev</code>. After reading and understanding the code it was pretty obvious what it does. See for yourself:</p>

<p><img src="/images/boiler/image-3.png" class="center" style="width: 60%"></p>

<p>it first initializes a seed to get psedurandom number from rand function.</p>

<p>It then looks for a number such that the bitwise XOR of param1, uvar1(storing first random number) and 0x3597b741 is equal to pseudorandom number uvar2 .</p>

<p>So I first made a script to do the reverse of all these operations in python (A nooby mistake, I know ). Python&rsquo;s random number function does not work in the same way like C rand function. So my team mate (<a href="https://ctftime.org/user/82627">DaBaddest</a>) made the reverse script in C and that worked :</p>

<p>His script :</p>

<figure class='code'><figcaption><span> (boiler.c)</span> <a href='/downloads/code/boiler.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">srand</span><span class="p">(</span><span class="mh">0x11C4</span><span class="p">)</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">printf</span><span class="p">(</span><span class="s">&quot; %d </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">rand</span><span class="p">()</span>  <span class="o">^</span> <span class="n">rand</span><span class="p">()</span> <span class="o">^</span> <span class="mh">0x3597B741</span><span class="p">)</span> <span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span> <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And this returned us the flag</p>

<p><strong>Flag</strong> : <code>bctf{1432175799}</code></p>

<h3>Swirler</h3>

<p>Another Easy reverse engineering challenge for beginners like me</p>

<p>Given files can be found from this <a href="https://ctf.b01lers.com/download?file_key=64844ebf04da4d9513927c3d720e00799c5db04477d7b6c496bab371edd889f3&amp;team_key=c2e8f607c31b1896dfe445997fb87e1315424096425ea90c9b38ee0cd0b39032">link</a> . With the files another <a href="http://chal.b01lers.com:8001">link</a> was also given to us .</p>

<p>Ok first lets look at the given files it was a png picture file nothing special. Lets look at the given link.</p>

<p>Main function of the site was to take a picture and &ldquo;swirl&rdquo; it so that no one can look at its contents. It was JS reverse engineering and was no big thing. I copied the source code of the site and used <a href="https://jsfiddle.net/">https://jsfiddle.net/</a> to deploy it and &lsquo;fiddle&rsquo; with source code side by side to see how it works.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">fsSource</span> <span class="o">=</span> <span class="err">`</span>
</span><span class='line'>    <span class="nx">precision</span> <span class="nx">highp</span> <span class="kr">float</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">varying</span> <span class="nx">vec2</span> <span class="nx">vPos</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">uniform</span> <span class="nx">sampler2D</span> <span class="nx">uSampler</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">uniform</span> <span class="nx">vec2</span> <span class="nx">uResolution</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">uniform</span> <span class="kr">float</span> <span class="nx">uTime</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">uniform</span> <span class="kr">float</span> <span class="nx">uRadius</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">uniform</span> <span class="kr">float</span> <span class="nx">uSwirlFactor</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">void</span> <span class="nx">main</span><span class="p">(</span><span class="k">void</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">vec2</span> <span class="nx">uv</span> <span class="o">=</span> <span class="nx">gl_FragCoord</span><span class="p">.</span><span class="nx">xy</span> <span class="o">/</span> <span class="nx">uResolution</span><span class="p">.</span><span class="nx">xy</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="kr">float</span> <span class="nx">dist</span> <span class="o">=</span> <span class="nx">distance</span><span class="p">(</span><span class="nx">uv</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));</span>
</span><span class='line'>      <span class="nx">mat2</span> <span class="nx">rotmat</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">&lt;</span> <span class="nx">uRadius</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">percent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">uRadius</span> <span class="o">-</span> <span class="nx">dist</span><span class="p">)</span> <span class="o">/</span> <span class="nx">uRadius</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">percent</span> <span class="o">*</span> <span class="nx">percent</span> <span class="o">*</span> <span class="nx">uSwirlFactor</span> <span class="o">*</span> <span class="nx">uTime</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">sina</span> <span class="o">=</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">cosa</span> <span class="o">=</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">rotmat</span> <span class="o">=</span> <span class="nx">mat2</span><span class="p">(</span><span class="nx">cosa</span><span class="p">,</span> <span class="nx">sina</span><span class="p">,</span> <span class="o">-</span><span class="nx">sina</span><span class="p">,</span> <span class="nx">cosa</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">rotmat</span> <span class="o">=</span> <span class="nx">mat2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">vec2</span> <span class="nx">texCoord</span> <span class="o">=</span> <span class="nx">rotmat</span> <span class="o">*</span> <span class="p">(</span><span class="nx">uv</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">vec4</span> <span class="nx">diffuse</span> <span class="o">=</span> <span class="nx">texture2D</span><span class="p">(</span><span class="nx">uSampler</span><span class="p">,</span> <span class="nx">texCoord</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">gl_FragColor</span> <span class="o">=</span> <span class="nx">diffuse</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="err">\`</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was the vulnerable script I just converted the following code block :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">&lt;</span> <span class="nx">uRadius</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">percent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">uRadius</span> <span class="o">-</span> <span class="nx">dist</span><span class="p">)</span> <span class="o">/</span> <span class="nx">uRadius</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">percent</span> <span class="o">*</span> <span class="nx">percent</span> <span class="o">*</span> <span class="nx">uSwirlFactor</span> <span class="o">*</span> <span class="nx">uTime</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">sina</span> <span class="o">=</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">cosa</span> <span class="o">=</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">rotmat</span> <span class="o">=</span> <span class="nx">mat2</span><span class="p">(</span><span class="nx">cosa</span><span class="p">,</span> <span class="nx">sina</span><span class="p">,</span> <span class="o">-</span><span class="nx">sina</span><span class="p">,</span> <span class="nx">cosa</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>to :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">&lt;</span> <span class="nx">uRadius</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">percent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">uRadius</span> <span class="o">-</span> <span class="nx">dist</span><span class="p">)</span> <span class="o">/</span> <span class="nx">uRadius</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">percent</span> <span class="o">*</span> <span class="nx">percent</span> <span class="o">*</span> <span class="o">-</span><span class="nx">uSwirlFactor</span> <span class="o">*</span> <span class="nx">uTime</span><span class="p">;</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">sina</span> <span class="o">=</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="kr">float</span> <span class="nx">cosa</span> <span class="o">=</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">angle</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">rotmat</span> <span class="o">=</span> <span class="nx">mat2</span><span class="p">(</span><span class="nx">cosa</span><span class="p">,</span> <span class="nx">sina</span><span class="p">,</span> <span class="o">-</span><span class="nx">sina</span><span class="p">,</span> <span class="nx">cosa</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>and ran the code with <code>flag.png</code> and we got a qrcode</p>

<p><img src="/images/boiler/canvas.png" class="center" style="width: 60%"></p>

<p>after scanning we got the flag :</p>

<p><strong>Flag:</strong> <code>pctf{sw1rly_sw1rly_qr_c0d3}</code></p>

<h2>WEB</h2>

<h3>gdpr</h3>

<p>This was a web challenge so a link was given : <a href="http://chal.b01lers.com:1004">chal.b01lers.com:1004</a></p>

<p>After opening the site It opened a page like this :</p>

<p><img src="/images/boiler/image-4.png" class="center" style="width: 60%">
If you look closely when the page is loaded it covers some content. So I disabled the JS on my browser to check what it is and it loaded a page like this :</p>

<p><img src="/images/boiler/image-5.png" class="center" style="width: 60%">
After visiting the link we got the flag</p>

<p><img src="/images/boiler/image-6.png" class="center" style="width: 60%"></p>

<p><strong>Flag</strong>: <code>bctf{annoying_but_good?}</code></p>

<p>Well that was it folks.</p>

<p>Will come again with some another interesting writeup.</p>

<p>Till then, farewell</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2021-04-06T00:00:00+05:30" pubdate data-updated="true">Apr 6th, 2021</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2021/01/24/Memory-Mapping-Introduction/">
		
			Memory Mapping Introduction</a>
	</h2>
	<div class="entry-content">
		<h4><strong>Memory mapping</strong></h4>

<p>Memory of computer has addresses for its smooth working. These addresses are same for everyone and does not change from use to use. The first byte is at address 0, the second byte is at address 1, and so on until the last byte of the computer&rsquo;s memory. Basically if I want to explain memory mapping in short there are memory registers that map memory. First a &ldquo;logical&rdquo; address is given to these processes which are currently running on the computer by CPU. This &ldquo;logical&rdquo; address is completely temporary and is not same for all users, its completely virtual. This process when becomes a permanent process, is assigned a &ldquo;physical&rdquo; address on the memory itself.</p>

<p>How exciting huh ? Well for me these things are very exciting üòÅ</p>

<p><strong>These mapping registers can only map data of 2 different size - 4096 bytes and 2 megabytes. Linux uses 2MB for the kernel and 4Kb for most other uses</strong>. Recent CPUs can support up to 1GB !!</p>

<p>To understand these concepts more clearly, you all can read this book (<a href="http://library.bagrintsev.me/ASM/Introduction%20to%2064bit%20Intel%20Assembly%20Language%20Programming%20for%20Linux.2011.pdf">link</a>) and watch this Youtube video by Ted-Ed <a href="https://www.youtube.com/watch?v=p3q5zWCw8J4&amp;t=22s">link</a></p>

<p>I have ended memory mapping in very short and has just given you a little overview because I can&rsquo;t explain everything here but you all can look the links that I have given you all.</p>

<p>So now comes the more exciting part. Ever heard of stack, heap etc. Well in this article you will be explained everything. That&rsquo;s why I just love assembly, It completely builds all the concepts clear related to working of computers.</p>

<h4><strong>Process Memory Model</strong></h4>

<p>For the smooth running of a process linux memory is divided into 4 logical segments- text, data, heap and stack. A process is mapped from lowest address i.e. <strong>text</strong> to the highest address i.e. <strong>stack</strong>.</p>

<p>Now before moving ahead I would like to discuss about 2 types of memory - <strong>logical and physical</strong>. <strong>The segmentation is done in the logical part</strong> of the memory because it can vary but the <strong>pages(blocks) are the part of physical part</strong> of the memory as a block size remains constant.</p>

<p><img src="/images/process-memory-dia.png" align="left">
<br></p>

<p><strong>Text</strong> - In assembly text segment is indicated by <code>.text</code> , It contains the machine instructions of a program. It basically tells the story of what program does.</p>

<p><strong>Data</strong> - Data segment contains all the <strong>static data</strong>. It is represented by <code>.data</code> .Which means it contains all variables that have been initialized in the program.</p>

<p><strong>.bss</strong> - Above data segment, there is <code>.bss</code> segment which stands for &ldquo;block started by symbol&rdquo;. Ths segment contains data which is statistically allocated in a process, but is not stored in the executable file. Instead this data is allocated when the process is loaded into <strong>memory</strong>.</p>

<p>.<strong>rodata</strong> - Sometimes <code>.rodata</code> is also seen. Basically <code>.rodata</code> is a segment where all the constants are placed and <code>.data</code> is a segment where all the variable are placed.</p>

<p><strong>Heap</strong> - Heap is basically some space reserved by the program so that it can use it for future purposes when calling functions like <code>malloc</code>.</p>

<p><strong>Stack</strong> - It is basically temporary storage space for a process. The size of stack is set by the linux kernel, typically to 16 MB. This is enough for our processes.</p>

<p>Now the above segments is for a page(block) of memory. So basically the minimum size of segments depends on page size.</p>

<p>The size of segments vary according to usage but the ultimate size of the page will remain same. for example Sometimes, you will see that processor is processing a lot of information in that case we can assume that .text part is large but other parts is small.Sometimes processing done is less but still <code>.data</code> is large but others are small. Sometimes a process needs more temporary storage for later use so stack will be more in size.</p>

<p><strong>Hello world program in assembly.</strong></p>

<p>I do not want you to understand the whole code below. Just observe how segmentation has been performed in the code and keep this code in the back of your mind so that you can understand and write codes yourself in the upcoming articles.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='asm'><span class='line'><span class="na">.section</span> <span class="no">.text</span>
</span><span class='line'>    <span class="na">.intel_syntax</span> <span class="no">noprefix</span>
</span><span class='line'>    <span class="no">.global</span> <span class="no">_start</span>
</span><span class='line'>    <span class="nl">_start:</span>
</span><span class='line'>        <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">1</span>
</span><span class='line'>        <span class="nf">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">1</span>
</span><span class='line'>        <span class="nf">lea</span> <span class="no">rsi</span><span class="p">,</span> <span class="err">[</span><span class="no">rip</span><span class="err">+</span><span class="no">msg</span><span class="err">]</span>
</span><span class='line'>        <span class="nf">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="mi">13</span>
</span><span class='line'>        <span class="nf">syscall</span>
</span><span class='line'>
</span><span class='line'>        <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">60</span>
</span><span class='line'>        <span class="nf">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>        <span class="nf">syscall</span>
</span><span class='line'>    <span class="nl">msg:</span>
</span><span class='line'>        <span class="na">.ascii</span> <span class="s">&quot;Hello world\n\0&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>To run this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gcc helloworld.s -nostdlib --static -o helloworld
</span><span class='line'>./helloworld
</span></code></pre></td></tr></table></div></figure>


<p>I have not added a lot of things in this article. So please read and view the following sources.</p>

<p><strong>Sources:</strong></p>

<p>Book link given in the <strong>previous article.</strong></p>

<p><a href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch10s04.html">http://www.cs.uwm.edu/classe</a><a href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch10s04.html">s/cs315/Bacon/Lecture/HTML/ch10s04.htm</a><a href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch10s04.html">l</a></p>

<p><a href="https://jameshfisher.com/2018/03/10/linux-assembly-hello-world/">https://jameshfisher.com/2018/03/10/linux-assembly-hello-world/</a></p>

<p><a href="https://web.stanford.edu/class/archive/cs/cs107/cs107.1212/schedule.html">https://web.stanford.edu/class/archive/cs/cs107/cs107.1212/schedule.html</a></p>

<p><a href="https://www.youtube.com/watch?v=HWwNTWY1rxo">https://www.youtube.com/watch?v=HWwNTWY1rxo</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2021-01-24T00:00:00+05:30" pubdate data-updated="true">Jan 24th, 2021</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/asm/'>asm</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2021/01/24/Introduction-To-Assembly-Language/">
		
			Introduction to Assembly Language</a>
	</h2>
	<div class="entry-content">
		<p>Every Computer has a processor, that processor as we have already guessed by its name, processes the information given to the computer. It performs basic operations like arithmetic calculations, logical and control operations for the computer. This processor understands 1s and 0s but for us humans to write code in 1s and 0s is very difficult and tedious so for this purpose assembly language was introduced. Assembly language makes it easy for us to communicate with computer and understand it more clearly.</p>

<p>Assembly language is often called <em>symbolic machine code</em>. It consists of a lot of short forms which is converted to machine language(1s and 0s) when passed through assembler. The following image was found online on the net, it will help you all to understand this concept more clearly.</p>

<p><img src="/images/Assembly-Language-vs-Machine-Language-1.png" class="center" style="width: 50%"></p>

<p>The above process of converting assembly language to machine code is called as <strong><em>assembly</em></strong>.</p>

<p>Ok, so up till now I think I have made my point clear that main purpose of assembly language or should I say every programming language is to understand computer and give it commands.</p>

<p>Now a assembly language is designed depending upon which processor we are using so in short it is processor specific. So it is possible that processor found in one PC may able to assemble code written in it but processor of other PC may not.</p>

<p>Assembly language is a low level language and is often abbreviated as <strong><em>asm</em></strong>. So first of all what is a low level language ?</p>

<p>Low level language does not mean that it is easy to learn or anything. Basically low level language basically means that it is a language that it is very similar to actual machine language and has less abstraction. By abstraction I mean changes added to that language so it becomes less complex and more understandable. The converse of it can be applied for high level languages like python, C, Java etc.</p>

<p>So What exactly are these 1&rsquo;s and 0&rsquo;s ?</p>

<p>These 1s and 0s are called <em>bits</em>. It is the smallest possible storage unit of computer.</p>

<h4>Bytes</h4>

<p>So we have understood bits but what are bytes ? Are they the same thing or different. Well many people think that bits and bytes are same but its false.</p>

<p>Nowadays processor interpret a specific number of bits at a time. They interpret 8 bits at a time. <strong>This cluster of 8 bits is known as <em>a byte</em></strong>. The main memory of the computer is composed of an array of bytes, with each byte having a separate memory address. The first byte address is 0 and the last address depends on the hardware and software in use. Any byte that is identified as a machine instruction is pushed into <strong>rbp register</strong> onto the run-time stack.</p>

<p><strong>After this you all must study the following concepts as it will make your concepts more clear:</strong></p>

<ul>
<li>Binary numbers</li>
<li>Binary arithmetic - addition, subtraction, multiplication and division</li>
<li>Hexadecimal numbers</li>
<li>Floating point numbers</li>
</ul>


<p>I learned the above topics from this book :</p>

<p><a href="http://library.bagrintsev.me/ASM/Introduction%20to%2064bit%20Intel%20Assembly%20Language%20Programming%20for%20Linux.2011.pdf">Introduction to 64 Bit Intel Assembly Language Programming for Linux</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2021-01-24T00:00:00+05:30" pubdate data-updated="true">Jan 24th, 2021</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/asm/'>asm</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/11/17/mr-Robot-TryHackMe/">
		
			Mr.Robot - TryHackMe</a>
	</h2>
	<div class="entry-content">
		<p>Hello guys, Mr.Robot is one of my most favorite series and today we will be solving its CTF.</p>

<p><strong>Level - Medium</strong></p>

<p>You all can attempt this CTF from this link:</p>

<p><a href="https://tryhackme.com/room/mrrobot">https://tryhackme.com/room/mrrobot</a></p>

<p>So let the hacking begin.</p>

<p>First lets start with <strong>reconnaissance</strong> therefore a <strong><em>nmap scan</em></strong>.</p>

<p><img src="/images/MrRobot/21.png" class="center" style="width: 70%"></p>

<p>Image of nmap scan</p>

<p>I ran the nmap scan and found 2 ports - 22 (ssh - closed) 80 (webserver).</p>

<p>Lets head to the Webserver.</p>

<p><img src="/images/MrRobot/22.png" class="center" style="width: 70%"></p>

<p>Well, as expected from this CTF box, we got a cool, terminal look webpage.</p>

<p>Lets enumerate this webpage for more information.</p>

<p>After looking at the source page, we can easily see its a WordPress site. So there are 2 ways from here: <strong>wpscan</strong>¬†or¬†<strong>gobuster</strong>.</p>

<p>The wpscan method is better as it takes less time to solve. I will explain both the methods.</p>

<h5>1st Method - wpscan</h5>

<p>As I have not used wpscan in my earlier writeups, I would try and explain what it is. wpscan is an inbuilt excellent Kali Tool to enumerate wordpress sites.</p>

<p>So, I enumerate it using wpscan and we found that it has a <strong><em>robots</em></strong> page. I can&rsquo;t attach the output of the command as it is too long.</p>

<p><em>&hellip;..continued after method 2</em></p>

<h5>2nd Method - gobuster</h5>

<p>I ran a <em><strong>gobuster dir</strong></em> search on it. It resulted in many <em>time exceeding errors</em>.</p>

<p>I went to all the sceptical URL&rsquo;s like <em>license, login, phpmyadmin</em> etc. and most of them provided me some good results and hints that we are looking in the right direction. Like the license one:</p>

<p><img src="/images/MrRobot/24.png" class="center" style="width: 70%">
Or the readme :</p>

<p><img src="/images/MrRobot/25.png" class="center" style="width: 70%">
Well, I think you all have got an idea from where we&rsquo;ll be getting the best results and if not, don&rsquo;t worry as it is <em><strong>robots</strong></em> file of the webserver.</p>

<h5>The Robots file</h5>

<p>When going at <strong>robots</strong> file:</p>

<p><img src="/images/MrRobot/26.png" class="center" style="width: 70%">
We see two locations on the webserver which were not discovered before. Now, here <em><strong>fsocity.dic</strong></em> is a wordlist and <strong>key-1-of-3.txt</strong> will reveal our first flag.</p>

<p><img src="/images/MrRobot/27.png" class="center" style="width: 70%">
Now, we have got a dictionary. Lets use it somewhere. I know that I can&rsquo;t use it for <em>ssh</em> brute forcing as the port is closed, so only one place is left where it can be used i.e., <em>the wordpress admin panel.</em></p>

<p>Now, the <em><strong>.dic</strong></em> file is of around 5 MB which means approx. 5 lakh usernames and password respectively to try out but we don&rsquo;t have that much time, we&rsquo;ll have to filter our possibilities. If somehow we get to know the username, 50% of the total possibilities can be reduced, that&rsquo;s a lot of reduction and time saving.</p>

<p>We can cut it down more by using <strong>uniq</strong> command by filtering out all the duplicate strings.</p>

<p>You can compare the sizes before and after the filter operation.</p>

<p><img src="/images/MrRobot/30.png" class="center" style="width: 70%">
So lets see how I enumerated the right user from the dictionary file.</p>

<p>I passed a lot of random credential pair like admin:admin , user:pass etc that are very common and I got common response: <em><strong>invalid username</strong></em>.</p>

<p><img src="/images/MrRobot/29.png" class="center" style="width: 70%">
I used this to enumerate the correct user using <strong><em>hydra</em></strong> tool. <strong><em>Hydra</em></strong> is a tool through which we can brute force password for different services.</p>

<p>We have got an idea that the &lsquo;<em>F</em>&rsquo; parameter of hydra command is <em>Invalid Username</em>. If username would have been correct, It wouldn&rsquo;t have shown us this message instead, it would have given us a message regarding <em>invalid password</em>.</p>

<p>I&rsquo;ll gather the required information using <em>burp suite.</em></p>

<p><img src="/images/MrRobot/31.png" class="center" style="width: 70%">
From the above data our command will be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hydra -L dict_sorted.txt -p TestPass 10.10.73.3 http-post-form "/wp-login/:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.73.3%2Fwp-admin%2F&testcookie=1:F=Invalid username"</span></code></pre></td></tr></table></div></figure>


<p>After some time:</p>

<p><img src="/images/MrRobot/32.png" class="center" style="width: 70%"></p>

<p>As you can see we found 3 usernames.</p>

<p>Lets run this <strong><em>Hydra</em></strong> again using username <strong><em>elliot</em></strong> but this time we will be using our wordlist in password field.</p>

<p><img src="/images/MrRobot/33.png" class="center" style="width: 70%">
So there we go, we found out the password of user <strong>elliot</strong>.</p>

<p>We have now got full control over the wordpress website. Lets see how can we exploit this to gain control over the system.</p>

<p>After exploring the wordpress dashboard, I explored that we can change the code of pre uploaded php files. I changed the code of one of the php file and changed it to already provided php-reverse-shell code in <strong><em>/usr/share/webshells/php</em></strong> directory. I copy-pasted the code after doing the required changes (host IP and port) and started a <strong><em>nc</em></strong> (<em>netcat listener</em>) .</p>

<p><img src="/images/MrRobot/34.png" class="center" style="width: 70%">
Visit the page that you have edited and get back to <strong><em>nc</em></strong> reverse shell and you&rsquo;ll see we have got back our reverse shell.</p>

<p><img src="/images/MrRobot/35.png" class="center" style="width: 70%"></p>

<p><img src="/images/MrRobot/36.png" class="center" style="width: 70%">
<strong>Note</strong>: <em>If you are unable to get a reverse shell, probably it is because of host&rsquo;s firewall.</em></p>

<p>At last, we have got a reverse shell. I navigated to the <strong>home</strong> directory where I found a user named <strong>robot</strong>. I checked his directory and I can see that we have successfully found our 2nd flag but we don&rsquo;t have the permission to read it. We have another file that basically contains the credential pair of robot user. But, here the password is encrypted.</p>

<p><img src="/images/MrRobot/37.png" class="center" style="width: 70%">
Lets try to Identify the hash type using <strong>hashid</strong> command. The top 3 possibilities are MD2, MD5 and MD4. I cracked the hash using this site: <a href="https://crackstation.net/">crackstation</a></p>

<p><img src="/images/MrRobot/38.png" class="center" style="width: 70%">
I changed the user to robot using <strong>su</strong> command. User <strong>robot</strong> can read that file and there we go we found our <strong>2nd flag</strong>.</p>

<p><img src="/images/MrRobot/40.png" class="center" style="width: 70%"></p>

<p>Now, I want the root access of the system and for that I&rsquo;ll have to do <strong>privilege escalation.</strong></p>

<p>I tried to inspect my sudo privileges but unfortunately, I can&rsquo;t run any command with sudo through user robot.</p>

<p>Lets see if we have any SUID privileges. We see from the output that <strong>nmap</strong> has SUID privileges. So lets exploit it.</p>

<p>I saw the privilege escalation of nmap from <a href="https://gtfobins.github.io/gtfobins/nmap/">gtfobins</a>. So, I tried the privilege escalation and bingo !! We did it.</p>

<p><img src="/images/MrRobot/41.png" class="center" style="width: 70%">
We now have root access !</p>

<p>I found the third flag in the root directory.</p>

<p><img src="/images/MrRobot/42.png" class="center" style="width: 70%"></p>

<hr />

<p>I am not a professional, so only feedback can make me better.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-11-17T00:00:00+05:30" pubdate data-updated="true">Nov 17th, 2020</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/medium/'>medium</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/11/13/Gotta-Catch-em-All-TryHackMe-writeUp/">
		
			Gotta Catch'em All! TryHackMe WriteUp</a>
	</h2>
	<div class="entry-content">
		<p>Hello guys, I am not a professional so feedback will be appreciated.</p>

<p><strong>level - very easy</strong></p>

<p><strong>You can attempt this CTF challenge here</strong>: <a href="https://tryhackme.com/room/pokemon">Gotta Catch em' all</a></p>

<p>So let the hacking begin.</p>

<p>Lets start with a nmap scan on the box.</p>

<p><img src="/images/gottacatchemallTHM/8.png" class="center" style="width: 60%"></p>

<p>As you can see we found port <strong>22 (ssh) and 80 (webserver)</strong> open.</p>

<p>As usual we go to the webpage and we found Apache default webpage running on it.</p>

<p><img src="/images/gottacatchemallTHM/9.png" class="center" style="width: 60%"></p>

<p>now I started inspecting elements and believe me this step took me a great amount of time. The author was very clever, he/she camouflaged the ssh credentials in inspect element itself just above the &ldquo;check the console&rdquo; comment</p>

<p><img src="/images/gottacatchemallTHM/10.png" class="center" style="width: 60%"></p>

<p>It was right in front of my eyes all the time but I was not able to find it but at last we found it.</p>

<p>lets login through ssh with the found credentials.</p>

<p>In <em><strong>Desktop</strong></em> directory I found a zip file. I unzip it and we found our first flag but its encoded and it looks like its in <strong>hex.</strong></p>

<p><img src="/images/gottacatchemallTHM/16.png" class="center" style="width: 60%"></p>

<p>I decoded this using this webite:</p>

<p><a href="https://www.asciitohex.com/">https://www.asciitohex.com/</a></p>

<p><img src="/images/gottacatchemallTHM/17.png" class="center" style="width: 60%">
So here we go our first flag.</p>

<p>After finding first flag I looked more into the home directory for some other interesting stuff and in videos I accessed a couple of subfolders after that I found a &lsquo;.cplusplus&rsquo; file.</p>

<p>I looked into it and voil√† we found credentials for other user- <em>ash</em>.</p>

<p><img src="https://hackolympus.files.wordpress.com/2020/11/image-12.png?w=1024" alt="" /></p>

<p><img src="/images/gottacatchemallTHM/12.png" class="center" style="width: 60%">
Now exit from ssh and login into user ash.</p>

<p>ash had a un-interactive shell</p>

<p>I checked my <strong>sudo</strong> privileges and here we go we can use all sudo commands for this user.</p>

<p>so I took no time to change my user into root.</p>

<p><img src="/images/gottacatchemallTHM/18.png" class="center" style="width: 60%">
Now we know that all flags are in this machine, we just have to search for it.</p>

<p>So I began my search and I found 2nd flag in in webserver folder in <em><strong>/var/www/html</strong></em></p>

<p>now if we run cat command we see</p>

<p><img src="/images/gottacatchemallTHM/14.png" class="center" style="width: 60%">
Now this is encoded and if you look closely it appears that words are rotated so its a rot algorithm. So I used the following site to decode it:</p>

<p>and there we go we found our second flag.</p>

<p><a href="http://theblob.org/rot.cgi">http://theblob.org/rot.</a><a href="http://theblob.org/rot.cgi">cgi</a></p>

<p>so if we decode it the rot 1 gives us understandable results</p>

<p><img src="/images/gottacatchemallTHM/15.png" class="center" style="width: 60%"></p>

<p>I looked into <em><strong>ash user</strong></em> folder but I found nothing interesting over there.</p>

<p>I searched into <strong>/home</strong> directory and I found <strong>roots-pokemon.txt</strong></p>

<p>I looked into it and we found the answer of <strong>task4 root&rsquo;s favorite pokemon.</strong></p>

<p>So I searched more but I could not find the last flag.</p>

<p>so I ran the <em><strong>find</strong></em> command</p>

<p><img src="/images/gottacatchemallTHM/19.png" class="center" style="width: 60%"></p>

<p>reading the above file we found that its also encoded and its base64 so I decoded it and we found our last flag.</p>

<p><img src="/images/gottacatchemallTHM/20.png" class="center" style="width: 60%"></p>

<p>Hope you enjoyed this writeup. Thanks all for reading.</p>

<p>Again I am not a professional so feedback is much appreciated.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-11-13T00:00:00+05:30" pubdate data-updated="true">Nov 13th, 2020</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/easy/'>easy</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/11/11/Linux-Basics-Part-2/">
		
			Linux Basics Part- 2</a>
	</h2>
	<div class="entry-content">
		<p><strong>Before beginning, I suggest all the readers, to try the following commands yourself as you read them</strong>.</p>

<h5><strong>Advanced File operators</strong></h5>

<p>recall using <em><strong>ls &ndash;all</strong></em> command privileges and various other attributes of <strong>files</strong> in that directory<br/>
<strong>Chmod</strong><br/>
chmod¬† allows to set different permissions for a file, and control who can read it. The syntax of this command is typically¬†<em><strong>chmod <permissions> <file></strong></em>.Permission setting system is very interesting and powerful. They are set in 3 digits</p>

<ul>
<li>first digit controls the <strong>permissions of a user</strong>.</li>
<li>second digit controls the <strong>permissions of a¬† group</strong>.</li>
<li>third digit controls the <strong>permissions of everyone that&rsquo;s not the part of user or group</strong>.</li>
</ul>


<table><tbody><tr><td class="has-text-align-center" data-align="center"><sup>Digit</sup></td><td class="has-text-align-center" data-align="center"><sup>meaning&nbsp;</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>1</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be executed&nbsp;</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>2</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be written to</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>4</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be read</sup></td></tr></tbody></table>


<p>Now how to give permission to the file using above logic.</p>

<p>Suppose we have to give all rights to the users and by all rights we mean <strong>execution, writing and reading</strong> in that case the number for this permission will be <strong>1+2+4 = 7</strong> so <strong>first number of chmod permission will be 7</strong>.</p>

<p>now if we want to give only <strong>writing and execution rights to groups</strong>. <strong>Our 2nd digit of chmod rights will be 1 + 4 = 5</strong></p>

<p>if we want to give <strong>only execution rights to everyone</strong> (except user and group) <strong>3rd digit of chmod permissions will be 1</strong>.</p>

<p><img src="/images/linux-basics-2/image-2.png" class="center" style="width: 60%"></p>

<p><strong>So our command will be: <em>chmod 751 <file>.</em></strong></p>

<p><strong>U</strong>-user <strong>G</strong>-group <strong>E</strong>-everyone that are not in group or user</p>

<p>now <strong><em>rw</em></strong> means &ldquo;read and write&rdquo; , meaning the user has read-write permissions to the file.</p>

<p><strong><em>r</em></strong> means read so group and everyone else has read privileges.</p>

<p>now if we look the <em>&lsquo;Downloads&rsquo;</em> folder we see <strong>drwxr-xr-x</strong></p>

<p>now what this means, <strong>d</strong> means directory,<strong>rw</strong> means read-write <strong>xr</strong> means execution rights and <strong>r</strong> means read. So user can access this directory and can read, write and execute the files in it. Group can execute and read and everyone else can execute.</p>

<p><strong>Note:</strong> It is possible to give someone no perms to a file, You can just put 0 as the digit. 770 Means that everyone that isn&rsquo;t a part of the user or group cant do anything to the file.</p>

<h5><strong>Chown</strong></h5>

<p>chown means change owner.It allows us to change <strong>the user and group for any file</strong>.The syntax is:</p>

<p><strong><em>chown user:group file</em></strong></p>

<p><strong>Note: chown is best used with sudo privivliges</strong></p>

<p>We can also change only user/group. For just we just write:</p>

<p><em><strong>chown <user>/<group> file</strong></em></p>

<p>important flag:</p>

<p><strong>&lsquo;-R&rsquo;</strong> - allows us to operate with every file in the directory at once.</p>

<h5>rm</h5>

<p><strong>rm means remove</strong>. So it removes the respective file <strong>permanently</strong>.So it is a very dangerous command.</p>

<p>To avoid any mishap. we either use -i or -I flag.</p>

<p><strong>Important Flags:</strong></p>

<p><strong>-i</strong> - asks for user&rsquo;s consent every time a file is deleted.</p>

<p><strong>-I</strong> asks for users&rsquo;s consent for deletion of every 3 files.</p>

<p><strong>-r</strong> used to delete a whole directory</p>

<h5>Find</h5>

<p>find is one my most favorite commands. It is simple and incredibly powerful. As it says, it allows user to find files.</p>

<p>True power of this command though comes from the parameters you provide it For example you can use <em><strong>find dir -user <username></strong></em> to list every file owned by a¬† specific user; you can use <em><strong>find¬† <dir> -group</strong>¬†<strong><group name></strong></em> to list every file owned by a specific group. The sheer customizability of the command is its most powerful.</p>

<p>Important flags:</p>

<p><strong>To search the entire directory</strong> - /</p>

<p><strong>To search current folder</strong> - <strong>.</strong></p>

<p><strong>to search file belonging to a group/user</strong> - <em>find <dir> -user/group <username>/<groupname></em></p>

<p><strong>to find that is executable -</strong><em>find <dir> -executable</em></p>

<p><strong>To find a empty file and folders -</strong><em>find <dir> -empty</em></p>

<p><strong>to find all readable file -</strong> <em>find <dir> -readable</em></p>

<p><strong>to find a file with particular extension -</strong> <em>find <dir> -name *.mp3</em></p>

<p><strong>Output of find command to a file -</strong> <em>find <dir> -name *.txt -fprint <file name to print to></em></p>

<p><strong>Find all directories whose name contains the word &ldquo;flag&rdquo; -</strong> <em>find / -type d -name &ldquo;*flag&rdquo;</em></p>

<p>now here type followed by d means directory if it was followed by f it meant files</p>

<p><em><strong>-name</strong></em> means name of the file/directory depending upon the <em>-type</em> flag</p>

<p><strong>error reduction (exclude all permission denied or error commands from the output) -</strong> <em>find <dir> <filename> 2> /dev/null</em>¬†</p>

<p>&ldquo;2>&rdquo; is common standard error (stderr) redirection method. I have redirected all the standard error to <strong>/dev/null</strong>, which is a device file. In comming writeups I&rsquo;ll be talking more on this</p>

<p><strong>/dev/null</strong> is like a null space or &ldquo;black hole&rdquo; of linux.</p>

<p>&ldquo;*&rdquo; is a wildcard operator, it generally means all.</p>

<p><strong>find size related file/directory search</strong></p>

<p>Now if we want to find file of a specific size, or near to (more or less) to that size, we use <strong><em>-size</em></strong> flag with some other important attributes.</p>

<table>
<thead>
<tr>
<th> Keyword </th>
<th> meaning </th>
</tr>
</thead>
<tbody>
<tr>
<td> c¬† </td>
<td> bytes </td>
</tr>
<tr>
<td> k </td>
<td> kilobytes </td>
</tr>
<tr>
<td> M </td>
<td> Megabytes </td>
</tr>
<tr>
<td> G </td>
<td> Gigabytes </td>
</tr>
</tbody>
</table>


<p>Now using the above table understand the following command.</p>

<p>if I want to find file named &ldquo;password&rdquo; my command will be which is less than 1 my command will be:</p>

<p><strong><em>find -type f -name &ldquo;password&rdquo; -size -1k</em></strong> <strong><em>2> /dev/null</em></strong></p>

<p>notice that I have redirected stderr (standard error) to /dev/null for error reduction</p>

<p>what if we want to find a file which is greater than 1 Mb but less than 5 Mb:</p>

<p><strong><em>find -type f -size +1M -size -5M</em></strong></p>

<p>so in short we use &ldquo;+&rdquo; for more than and &ldquo;-&rdquo; for less than.</p>

<p><strong>time related commmands</strong></p>

<p>Now there are 3 attributes for time related commands:</p>

<ul>
<li><strong>-atime</strong> : access time</li>
<li><strong>-mtime</strong> : modification time</li>
<li><strong>-ctime</strong> : change time</li>
</ul>


<p>now if I want to find a file <strong>that is accessed precisely 4 days ago</strong> then we will use: <em><strong>-atime 4</strong></em></p>

<p>if I want to find a file that is accesse_d<em> <strong>within last 4 days</strong></em>: <strong>-atime -4</strong>_</p>

<p>If we want to find file that was <strong>accessed recently(within 24 hours)</strong> then we use <strong>-atime 0</strong></p>

<p>if I want to find a file that is accessed <strong>after 4 da_ys_</strong><em>: <strong>-atime +4</strong></em></p>

<p>the same logic applies for <strong><em>-mtime</em></strong> and <strong><em>-ctime</em></strong></p>

<p>Now what if, we don&rsquo;t want to find files using hours but minutes, then we use <strong><em>-min</em> using the above attributes - a,c or m</strong> and everything else is also same.</p>

<p><strong>-perm</strong> flag</p>

<p>As I have written earlier in chmod:</p>

<table><tbody><tr><td class="has-text-align-center" data-align="center"><sup>Digit</sup></td><td class="has-text-align-center" data-align="center"><sup>meaning&nbsp;</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>1</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be executed&nbsp;</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>2</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be written to</sup></td></tr><tr><td class="has-text-align-center" data-align="center"><sup>4</sup></td><td class="has-text-align-center" data-align="center"><sup>the file can be read</sup></td></tr></tbody></table>


<p><strong><em>-perm</em></strong> also uses the above digits with same meaning to search for permission.</p>

<p><strong><em>-perm</em></strong> accept 4 bit input which means a 4 digit number.</p>

<ul>
<li>1st bit - special privileges like SUID</li>
<li>2nd bit - owner privileges</li>
<li>3rd bit - group privileges</li>
<li>4th bit for everyone else</li>
</ul>


<p><strong>general syntax :</strong> <em>find -perm <mode></em></p>

<p>there are 3 different modes:</p>

<ul>
<li>if we just give permission through bits(example -perm 444), files with that <strong>particular permissions</strong> will be shown.</li>
<li>If we use &ldquo;-&rdquo; as prefix to bit-permission, files <strong>with at least one of the permission will be shown</strong>(for example if we search for 666 and some file has 776 then it will be shown)</li>
<li>If we use &ldquo;/&rdquo; either the owner the group or other should have the permission to the file For example, if we do¬†<code>find -perm /555</code>, and if a file has¬†<code>544</code> then it will be shown because user privileges are satisfied.</li>
</ul>


<p><strong>Using Symbolic Notation</strong> <strong>to search for permissions</strong></p>

<p>In symbolic notations</p>

<p><strong>u -> user g -> group o -> others</strong></p>

<p><strong>r -> read w -> write x -> executable</strong></p>

<p>for instance:</p>

<p>if we want to find file with all user having executable permission then:</p>

<p><em><strong>find -perm -u=x</strong></em></p>

<p>if we want to find file with all user having read write and groups having executable permission then:</p>

<p><em><strong>find -perm -u=rw,-g=x</strong></em></p>

<p><strong>Note</strong>: we can use &ldquo;=&rdquo; or &ldquo;+&rdquo; the output will be same</p>

<p><strong>-not</strong> flag</p>

<p>Suppose we have to find all files except the ones having provided permission then we use <em><strong>-not</strong></em> flag.</p>

<p>for instance all files except the one having permission 777 then:</p>

<p><em><strong>find -type f -not -perm 777</strong></em></p>

<p><strong>*Combining find commands with linux operators can be really helpful.</strong></p>

<p>**<strong>Find command really helps in solving CTF challenges. There are many other find commands. I suggest you all to look over the man page of this command.</strong></p>

<h5>Grep</h5>

<p>This command allows you to find specific string inside data.</p>

<p>The syntax of this command is:</p>

<p><strong>grep <string> <file></strong></p>

<p><strong>for multiple files:grep <string> <file1> <file2> &hellip;..</strong></p>

<p>Using grep with find makes the it usability to increase by tenfolds.</p>

<h4>Standard Unix Streams</h4>

<p>If you have not understood what I did during <strong>find</strong> command, this will probably help you</p>

<ul>
<li><strong>stdin</strong> ‚àí This is referred to as the <em>standard input</em> and the associated file descriptor is 0. This is also represented as STDIN. The Unix program will read the default input from STDIN.</li>
<li><strong>stdout</strong> ‚àí This is referred to as the <em>standard output</em> and the associated file descriptor is 1. This is also represented as STDOUT. The Unix program will write the default output at STDOUT</li>
<li><strong>stderr</strong> ‚àí This is referred to as the <em>standard error</em> and the associated file descriptor is 2. This is also represented as STDERR. The Unix program will write all the error messages at STDERR.</li>
</ul>


		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-11-11T00:00:00+05:30" pubdate data-updated="true">Nov 11th, 2020</time></div>
	


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/11/10/Linux-Basics-Part-1/">
		
			Linux Basics Part-1</a>
	</h2>
	<div class="entry-content">
		<p><strong>Before beginning, I suggest all the readers, to try the following commands yourself as you read them.</strong></p>

<h3>Man</h3>

<p><strong>man</strong>: man command opens a manual of that respective command.</p>

<p><strong>syntax :</strong> <code>man &lt;command&gt;</code></p>

<h3>cd</h3>

<p><strong>cd</strong>: cd means change directory. This command helps us to navigate through directories.</p>

<p><strong>syntax:</strong> <code>cd &lt;absolute path&gt;</code> - navigate to absolute path (example: <em>cd /home/<username>/</em>).</p>

<h3>ls</h3>

<p><strong>ls</strong>:ls means list. This command is used to list all files in the directory.</p>

<p>Some important flags :</p>

<ul>
<li>To print all files including the ones starting with a dot(.) (these are hidden), we use: <code>ls -a</code></li>
<li>To see details of all files including the owner and the set rights of the file: <code>ls -all</code></li>
</ul>


<h3>cat</h3>

<p><strong>cat</strong>: If want to see what is a text written in any file, we use this command</p>

<h3>touch</h3>

<p><strong>touch</strong>: This command creates an empty file</p>

<p><strong>syntax</strong> <code>touch &lt;filename&gt;</code></p>

<h3><strong>Running a binary</strong>:</h3>

<p>we use &lsquo;./&rsquo; followed by the name of the file to run the file in Linux.</p>

<p><img src="/images/linux-basics-1/image.png" class="center" style="width:60%"></p>

<h3>su</h3>

<p><strong>su</strong> - This allows us to switch user within terminal without actually signing off.</p>

<p><strong>syntax</strong> : <code>su &lt;username&gt;</code></p>

<h3>mkdir</h3>

<p><strong>mkdir</strong> - <strong>mkdir means make directory</strong>.It is used to make directory.</p>

<p><strong>syntax:</strong> <code>mkdir &lt;directory name&gt;</code></p>

<p><strong>Note: absolute path also works instead of giving name to file</strong></p>

<h3>mv</h3>

<p><strong>mv</strong>: mv (move) allows yo to <strong>move files from one place to another</strong>.</p>

<p><strong>Syntax :</strong> <code>mv &lt;file&gt; &lt;destination&gt;</code></p>

<p>if we want to move to home location we can just type using relative path: <em>mv <file> ~</em></p>

<p>we can also use mv to rename file:</p>

<p><code>mv &lt;file&gt; &lt;newfilename&gt;</code></p>

<h3>cp</h3>

<p><strong>cp (copy)</strong> - use to copy file from one destination to another.</p>

<p><strong>syntax:</strong> <code>cp &lt;file&gt; &lt;destination&gt;</code></p>

<p>To copy entire directory we use <strong>&ldquo;-r&rdquo;</strong> flag</p>

<h3>wc</h3>

<p><strong>wc (word count)</strong> - used to count total number of words and lines in a file</p>

<p><img src="/images/linux-basics-1/wc.png" class="center" style="width: 60%"></p>

<p><strong>First Column</strong> ‚àí Represents the <strong>total number of lines in the file</strong>.</p>

<p><strong>Second Column</strong> ‚àí Represents the <strong>total number of words in the file.</strong></p>

<p><strong>Third Column</strong> ‚àí Represents the <strong>total number of bytes in the file.</strong> This is the actual size of the file.</p>

<p><strong>Fourth Column</strong> ‚àí Represents the <strong>file name</strong></p>

<h3><strong>Linux operators</strong></h3>

<p><strong>&ldquo;>&rdquo;</strong>¬†<strong>-</strong>¬†To redirect the output to a specific file . <strong>It will completely erase the contents in the file</strong>.</p>

<p><strong>&ldquo;>>&rdquo;-</strong>¬† It is just like &ldquo;>&rdquo; but difference is, <strong>it appends the output to the file</strong>.</p>

<p><strong>&ldquo;&amp;&amp;&rdquo;</strong>¬†<strong>-</strong>¬† It is just like <strong>&ldquo;and&rdquo; of linux command line</strong> .It will first run the first command and then the second. if either of the command is wrongly typed or has a syntax error of some type it will just show : <em>Command not found</em></p>

<p><strong>&ldquo;;&rdquo;(semi colon)</strong>: to run multiple commands at the same time. Execution of command goes sequentially</p>

<p><strong>&ldquo;||&rdquo; (Or operator):</strong> If one command fails other command <strong>successfully runs</strong></p>

<p><strong>&ldquo;|&rdquo; (PIPE operator):</strong> Pipe the output of first command into the input of second command.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-11-10T00:00:00+05:30" pubdate data-updated="true">Nov 10th, 2020</time></div>
	


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/10/16/Magic-Number/">
		
			Magic Number</a>
	</h2>
	<div class="entry-content">
		<p>Ever heard of file signatures or magic number of a file ?</p>

<ul>
<li><p>File Signature or magic number are special parts in the starting of hex-dump through which we can interpret the file type/extension</p></li>
<li><p>We can use magic number to solve ctf challenges and forensics.</p></li>
<li><p>Sometimes files get corrupt because there is a change in magic number. Solving this problem can un-corrupt that respective file.</p></li>
<li><p>to see magic number we use any hexadecimal editor or viewer.</p></li>
</ul>


<p>for this tutorial I&rsquo;ll use xxd but windows users can use <a href="https://mh-nexus.de/en/hxd/">HxD</a>.</p>

<h3>xxd</h3>

<p>xxd is a tool to make hexdump or reverse that is convert hexdumpt to binary.</p>

<p><strong>general syntax</strong>: <code>xxd &lt;flag&gt; &lt;filename&gt;</code></p>

<p>When no flag is given xxd, standard output is printed by xxd.</p>

<p><strong>Important flags</strong>:</p>

<ul>
<li><strong><em>-b</em></strong> - show binary dump instead of hexdump</li>
<li><strong><em>-c</em></strong> - output is in the form of &lsquo;C&rsquo; include file style</li>
<li><strong><em>-ps</em></strong> - detailed hexdump</li>
</ul>


<p>Now I would like to introduce you to a command <strong><em>&lsquo;head&rsquo;</em></strong>.</p>

<h3>Head command</h3>

<p>This command basically outputs few starting lines of the file.</p>

<p><strong>general syntax</strong>: <code>head &lt;flag&gt; &lt;file&gt;</code></p>

<p>If no flag is given then by default this will print the first 10 lines of a file</p>

<p><strong>important flags</strong>:</p>

<ul>
<li><strong><em>-n</em></strong> <num> - &ldquo;-n&rdquo; followed by a number, will print that respective number of lines.</li>
<li><strong>-q</strong> - this will never print header of file containing its name</li>
<li><strong>-c</strong> <num>- &ldquo;-c&rdquo; followed by a number will print the given number of bytes of a file from the start.</li>
</ul>


<p>So now you know the necessary commands lets get back to magic number.</p>

<p>So as I was saying that starting bytes of a file will tell us about the extension of the file.</p>

<p>so what we do with <em>xxd</em> and <em>head</em> is, we print the first few lines of hexdump. This few lines contains our magic number.We look for a special sequence of hex this special sequence is known as magic number and this will tell us the extension of file.</p>

<p>You&rsquo;ll understand it more clearly by the following example.</p>

<p>I have a file.</p>

<p><img src="https://hackolympus.files.wordpress.com/2020/11/image-3.png?w=495" alt="" /></p>

<p><img src="/images/magic-number/image-3.png"></p>

<p>I don&rsquo;t know the file type so what I&rsquo;ll do, I will check its hexdump.</p>

<p><img src="/images/magic-number/image-5.png"></p>

<p>through its hex dump I can easily see its a jpeg file as we know that magic number for jpeg is <strong><code>ffd8 ffe0 0010 4a96</code></strong>. Sure we could have also checked this without using hexdump and using <em><strong>file</strong></em> command but file command also uses the same logic.</p>

<p>But sometimes(specially in ctf challenges) hexdump is modified and file becomes corrupt hence unreadable so to fix that we modify the hashdump.</p>

<p>Now lets look another example.</p>

<p>I have a file named file2 I don&rsquo;t know its file type. So I use magic number to find out what file extension it has.</p>

<p><img src="/images/magic-number/image-7.png"></p>

<p>And there we go, we found it its a pdf file.</p>

<p>I suggest you to practice with some of the files by yourself.</p>

<p>Check out this link to view the file signatures of different files.</p>

<p><a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-10-16T00:00:00+05:30" pubdate data-updated="true">Oct 16th, 2020</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/forensics/'>forensics</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/10/11/Brooklyn-Nine-Nine-TryHackMe/">
		
			Brooklyn Nine Nine - TryHackMe</a>
	</h2>
	<div class="entry-content">
		<p>Hello guys. This is my first tryhackme writeup so please give your honest reviews. Since I am not a professional, your honest reviews will charge my batteries.</p>

<p>To attempt this machine go to this link : <a href="https://tryhackme.com/room/brooklynninenine">Brooklyn99</a></p>

<p>So let the hacking begin.</p>

<p>Lets start by doing reconnaissance.</p>

<p>First, I ran a basic nmap version scan on the box.</p>

<p><img src="/images/b99/image-1.png" class="center", style="width: 60%"></p>

<p>As we can see there are 3 ports open. First, I went to the webpage of the machine.</p>

<p><img src="/images/b99/image-2.png" class="center", style="width: 60%"></p>

<p>uff, A rabbit hole I viewed the page source but i found nothing special.</p>

<p>Next I inspected FTP port. I tried anonymous login and it worked:</p>

<p><img src="/images/b99/image-3.png" class="center", style="width: 60%"></p>

<p>And we found a file: <strong>note_to_jake.txt</strong>. I downloaded the file by using get file command</p>

<p>Lets see what is written in that file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>From Amy,Jake please change your password. It is too weak and holt will be mad if someone hacks into the nine nine</span></code></pre></td></tr></table></div></figure>


<p>Looks like we have found a vulnerable username - <strong>jake</strong></p>

<p>lets fire up hydra and let it do the rest of the job.</p>

<p><img src="/images/b99/image-4.png" class="center", style="width: 60%">
we have found a password lets try to connect using that password</p>

<p><strong>LOGIN SUCCESSFUL</strong></p>

<p>Lets enumerate this machine.</p>

<p>In the user folder of jake. We found nothing interesting. I ran <strong>sudo -l</strong> command to see if I have any admin rights and yes i was right.</p>

<p><img src="/images/b99/image-5.png" class="center", style="width: 60%">
we can run <strong>less</strong> command with sudo rights.</p>

<p>From here I went to <strong>holt</strong> user folder where I found user.txt but only <strong>holt</strong> could open it from his user but as we all know we have sudo privileges on less command so I viewed it with less.</p>

<p><img src="/images/b99/image-6.png" class="center", style="width: 60%">
And here we go, we found our first flag.</p>

<h5><strong>Privilege Escalation</strong></h5>

<p>Time for privilege escalation. In the <strong>holt</strong> user folder I found another file: <strong>nano.save</strong></p>

<p>We will use this file for privilege escalation</p>

<p>We will open this file with sudo privileges using less</p>

<p><img src="/images/b99/image-7.png" class="center", style="width: 60%">
We will run the following command to open shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>!/bin/bash</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/b99/image-8.png" class="center", style="width: 60%">
And here we go, we got a root shell.</p>

<p><img src="/images/b99/image-9.png" class="center", style="width: 60%">
Now just go to root folder and we will get <strong>root.txt</strong></p>

<p><img src="/images/b99/image-10.png" class="center", style="width: 60%">
This is my first writeup so any suggestions will be highly appreciated</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-10-11T00:00:00+05:30" pubdate data-updated="true">Oct 11th, 2020</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/easy/'>easy</a>

</div>


</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2020/10/08/zip-file-password-bruteforcer/">
		
			Zip File Password Bruteforcer</a>
	</h2>
	<div class="entry-content">
		<p>Sometime we know a lot about our victim. Now consider a situation where victim has created a zip file but has protected it with a password. You don‚Äôt know what exactly the password is but you surely what password he/she can use (considering you have done enough reconnaissance on your victim).</p>

<p>So what to do in these kinds of situations ? Should we test the every possible password, well that‚Äôs a good option but sometimes our wordlist is so long the it becomes tedious to test them by our self. So what we can do is, we can build a simple script which will test all the password in a file and will return us the correct password.</p>

<ol>
<li>For this, we will be using Python‚Äôs built in <em><strong>zipfile</strong></em> module and sys module as we want to take arguments from the user.</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">zipfile</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span></code></pre></td></tr></table></div></figure>


<p>2.Now we will check if user has given correct intput or not.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">zipfile</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Usage : python3 zipfile.py &lt;wordlist&gt; &lt;zipfile&gt;&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>3.If input is correct then:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">zipfile</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Usage : python3 zipfile.py &lt;wordlist&gt; &lt;zipfile&gt;&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span class='line'>    <span class="nb">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>\<span class="p">[</span><span class="mi">1</span>\<span class="p">]</span>
</span><span class='line'>    <span class="n">zf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span>\<span class="p">[</span><span class="mi">2</span>\<span class="p">])</span>
</span><span class='line'>    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">words</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span><span class='line'>        <span class="n">pwd</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>        <span class="k">try</span><span class="p">:</span>
</span><span class='line'>            <span class="n">zf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">pwd</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">pwd</span><span class="p">))</span>
</span><span class='line'>            <span class="k">print</span><span class="p">(</span><span class="s">&quot;\[+\] Password found: {} Success&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pwd</span><span class="p">))</span>
</span><span class='line'>            <span class="k">break</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">except</span><span class="p">:</span>
</span><span class='line'>            <span class="k">continue</span>
</span><span class='line'>        <span class="k">else</span><span class="p">:</span><span class="k">print</span><span class="p">(</span><span class="s">&quot;\[-\] Not Found use more dense wordlist&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now what the code does is:</p>

<p>first it opens the wordlist and then executes a &lsquo;for&rsquo; loop. Through this for loop it tries string in each line as password of the file. If the password is correct, it will extract the files of the zip file and then it will extract that zip file. If not then, We&rsquo;ll have to use more dense wordlist i.e. wordlist containing more possibilities</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  



<time datetime="2020-10-08T00:00:00+05:30" pubdate data-updated="true">Oct 8th, 2020</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/python-for-pentesting/'>python-for-pentesting</a>

</div>


</div>
</article>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2021
 Zeus 
<br>
Powered by Octopress.
</footer>
	

</body>
</html>
